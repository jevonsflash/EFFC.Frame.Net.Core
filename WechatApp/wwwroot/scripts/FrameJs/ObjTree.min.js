if(typeof XML=="undefined")XML=function(){};XML.ObjTree=function(){return this};XML.ObjTree.VERSION="0.23";XML.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n';XML.ObjTree.prototype.attr_prefix="-";XML.ObjTree.prototype.parseXML=function(e){var t;if(window.DOMParser){var r=new DOMParser;var n=r.parseFromString(e,"application/xml");if(!n)return;t=n.documentElement}else if(window.ActiveXObject){r=new ActiveXObject("Microsoft.XMLDOM");r.async=false;r.loadXML(e);t=r.documentElement}if(!t)return;return this.parseDOM(t)};XML.ObjTree.prototype.parseHTTP=function(e,t,r){var n={};for(var o in t){n[o]=t[o]}if(!n.method){if(typeof n.postBody=="undefined"&&typeof n.postbody=="undefined"&&typeof n.parameters=="undefined"){n.method="get"}else{n.method="post"}}if(r){n.asynchronous=true;var i=this;var a=r;var s=n.onComplete;n.onComplete=function(e){var t;if(e&&e.responseXML&&e.responseXML.documentElement){t=i.parseDOM(e.responseXML.documentElement)}a(t,e);if(s)s(e)}}else{n.asynchronous=false}var f;if(typeof HTTP!="undefined"&&HTTP.Request){n.uri=e;var l=new HTTP.Request(n);if(l)f=l.transport}else if(typeof Ajax!="undefined"&&Ajax.Request){var l=new Ajax.Request(e,n);if(l)f=l.transport}if(r)return f;if(f&&f.responseXML&&f.responseXML.documentElement){return this.parseDOM(f.responseXML.documentElement)}};XML.ObjTree.prototype.parseDOM=function(e){if(!e)return;this.__force_array={};if(this.force_array){for(var t=0;t<this.force_array.length;t++){this.__force_array[this.force_array[t]]=1}}var r=this.parseElement(e);if(this.__force_array[e.nodeName]){r=[r]}if(e.nodeType!=11){var n={};n[e.nodeName]=r;r=n}return r};XML.ObjTree.prototype.parseElement=function(e){if(e.nodeType==7){return}if(e.nodeType==3||e.nodeType==4){var t=e.nodeValue.match(/[^\x00-\x20]/);if(t==null)return;return e.nodeValue}var r;var n={};if(e.attributes&&e.attributes.length){r={};for(var o=0;o<e.attributes.length;o++){var i=e.attributes[o].nodeName;if(typeof i!="string")continue;var a=e.attributes[o].nodeValue;if(!a)continue;i=this.attr_prefix+i;if(typeof n[i]=="undefined")n[i]=0;n[i]++;this.addNode(r,i,n[i],a)}}if(e.childNodes&&e.childNodes.length){var s=true;if(r)s=false;for(var o=0;o<e.childNodes.length&&s;o++){var f=e.childNodes[o].nodeType;if(f==3||f==4)continue;s=false}if(s){if(!r)r="";for(var o=0;o<e.childNodes.length;o++){r+=e.childNodes[o].nodeValue}}else{if(!r)r={};for(var o=0;o<e.childNodes.length;o++){var i=e.childNodes[o].nodeName;if(typeof i!="string")continue;var a=this.parseElement(e.childNodes[o]);if(!a)continue;if(typeof n[i]=="undefined")n[i]=0;n[i]++;this.addNode(r,i,n[i],a)}}}return r};XML.ObjTree.prototype.addNode=function(e,t,r,n){if(this.__force_array[t]){if(r==1)e[t]=[];e[t][e[t].length]=n}else if(r==1){e[t]=n}else if(r==2){e[t]=[e[t],n]}else{e[t][e[t].length]=n}};XML.ObjTree.prototype.writeXML=function(e){var t=this.hash_to_xml(null,e);return this.xmlDecl+t};XML.ObjTree.prototype.hash_to_xml=function(e,t){var r=[];var n=[];for(var o in t){if(!t.hasOwnProperty(o))continue;var i=t[o];if(o.charAt(0)!=this.attr_prefix){if(typeof i=="undefined"||i==null){r[r.length]="<"+o+" />"}else if(typeof i=="object"&&i.constructor==Array){r[r.length]=this.array_to_xml(o,i)}else if(typeof i=="object"){r[r.length]=this.hash_to_xml(o,i)}else{r[r.length]=this.scalar_to_xml(o,i)}}else{n[n.length]=" "+o.substring(1)+'="'+this.xml_escape(i)+'"'}}var a=n.join("");var s=r.join("");if(typeof e=="undefined"||e==null){}else if(r.length>0){if(s.match(/\n/)){s="<"+e+a+">\n"+s+"</"+e+">\n"}else{s="<"+e+a+">"+s+"</"+e+">\n"}}else{s="<"+e+a+" />\n"}return s};XML.ObjTree.prototype.array_to_xml=function(e,t){var r=[];for(var n=0;n<t.length;n++){var o=t[n];if(typeof o=="undefined"||o==null){r[r.length]="<"+e+" />"}else if(typeof o=="object"&&o.constructor==Array){r[r.length]=this.array_to_xml(e,o)}else if(typeof o=="object"){r[r.length]=this.hash_to_xml(e,o)}else{r[r.length]=this.scalar_to_xml(e,o)}}return r.join("")};XML.ObjTree.prototype.scalar_to_xml=function(e,t){if(e=="#text"){return this.xml_escape(t)}else{return"<"+e+">"+this.xml_escape(t)+"</"+e+">\n"}};XML.ObjTree.prototype.xml_escape=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};